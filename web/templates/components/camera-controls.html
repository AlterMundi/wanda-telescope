{% set slider_id = 'exposure-slider' %}
{% set iso_id = 'iso-slider' %}

<div class="ui-controls">
    <form method="post" class="ui-form" data-component="camera">
        <section class="ui-control-group" data-collapsible>
            <header class="ui-control-header" data-collapsible-trigger>
                <span class="ui-control-title">Exposure Settings</span>
                <svg viewBox="0 0 24 24" aria-hidden="true" class="ui-icon ui-icon--chevron"><path d="M12 15.5 6.5 10l1.4-1.4L12 12.7l4.1-4.1L17.5 10Z"/></svg>
            </header>
            <div class="ui-control-body" data-collapsible-content>
                <div class="ui-field">
                    <label for="{{ slider_id }}" class="ui-field__label">Exposure Time</label>
                    <div class="ui-field__value">
                        <input id="{{ slider_id }}" type="range" name="exposure" min="0" max="1000" step="1"
                               value="{{ slider_value }}" data-role="exposure-slider">
                        <output data-bind="exposure-display">{{ current_exposure }}</output>
                    </div>
                    <p class="ui-field__hint">Range: 0.1s â€“ 230s</p>
                </div>
                <div class="ui-button-grid">
                    <button type="button" class="ui-chip-button" data-preset="0.5">Bright Objects</button>
                    <button type="button" class="ui-chip-button" data-preset="30">Deep Sky</button>
                    <button type="button" class="ui-chip-button" data-preset="180">Long Exposure</button>
                </div>
            </div>
        </section>

        <section class="ui-control-group" data-collapsible>
            <header class="ui-control-header" data-collapsible-trigger>
                <span class="ui-control-title">ISO Sensitivity</span>
                <svg viewBox="0 0 24 24" aria-hidden="true" class="ui-icon ui-icon--chevron"><path d="M12 15.5 6.5 10l1.4-1.4L12 12.7l4.1-4.1L17.5 10Z"/></svg>
            </header>
            <div class="ui-control-body" data-collapsible-content>
                <div class="ui-field">
                    <label for="{{ iso_id }}" class="ui-field__label">ISO</label>
                    <div class="ui-field__value">
                        <input id="{{ iso_id }}" type="range" name="iso" min="0" max="1000" step="1"
                               value="{{ iso_slider_value }}" data-role="iso-slider">
                        <output data-bind="iso-display">{{ current_iso_label }}</output>
                    </div>
                </div>
            </div>
        </section>

        <section class="ui-control-group" data-collapsible>
            <header class="ui-control-header" data-collapsible-trigger>
                <span class="ui-control-title">Image Quality</span>
                <svg viewBox="0 0 24 24" aria-hidden="true" class="ui-icon ui-icon--chevron"><path d="M12 15.5 6.5 10l1.4-1.4L12 12.7l4.1-4.1L17.5 10Z"/></svg>
            </header>
            <div class="ui-control-body" data-collapsible-content>
                <div class="ui-field">
                    <label class="ui-field__label">Night Vision Mode</label>
                    <div class="ui-field__switch">
                        <input type="checkbox" name="night_vision_mode" id="night-vision" class="ui-switch"
                               {{ 'checked' if night_vision_mode else '' }} data-role="night-vision-toggle">
                        <label for="night-vision">Enable</label>
                    </div>
                </div>
                <div class="ui-field" data-night-vision-intensity>
                    <label for="night-vision-intensity" class="ui-field__label">Night Vision Intensity</label>
                    <div class="ui-field__value">
                        <input id="night-vision-intensity" type="range" name="night_vision_intensity"
                               min="1.0" max="80.0" step="0.1" value="{{ night_vision_intensity }}"
                               {{ '' if night_vision_mode else 'disabled' }}>
                        <output data-bind="night-vision-display">{{ night_vision_intensity }}</output>
                    </div>
                </div>
                <div class="ui-button-grid">
                    <button type="button" class="ui-chip-button" data-night-vision-preset="10">Low</button>
                    <button type="button" class="ui-chip-button" data-night-vision-preset="40">Medium</button>
                    <button type="button" class="ui-chip-button" data-night-vision-preset="70">High</button>
                </div>
                <div class="ui-field">
                    <label class="ui-field__label">Save RAW Files</label>
                    <div class="ui-field__switch">
                        <input type="checkbox" name="save_raw" id="save-raw" class="ui-switch"
                               {{ 'checked' if save_raw else '' }}>
                        <label for="save-raw">Enable</label>
                    </div>
                </div>
            </div>
        </section>

        <section class="ui-control-group" data-collapsible>
            <header class="ui-control-header" data-collapsible-trigger>
                <span class="ui-control-title">Performance</span>
                <svg viewBox="0 0 24 24" aria-hidden="true" class="ui-icon ui-icon--chevron"><path d="M12 15.5 6.5 10l1.4-1.4L12 12.7l4.1-4.1L17.5 10Z"/></svg>
            </header>
            <div class="ui-control-body" data-collapsible-content>
                <div class="ui-field">
                    <label for="performance" class="ui-field__label">Quality vs CPU Usage</label>
                    <div class="ui-field__value">
                        <input id="performance" type="range" name="performance" min="0" max="5" step="1"
                               value="{{ skip_frames }}" data-role="performance-slider">
                        <output data-bind="performance-display">{{ performance_text }}</output>
                    </div>
                </div>
            </div>
        </section>

        <div class="ui-form__actions">
            <button type="submit" class="ui-button ui-button--primary">Apply Settings</button>
        </div>
    </form>

    <div class="ui-divider"></div>

    <div class="ui-stack" data-component="capture-actions">
        <div class="ui-status" data-countdown></div>
        <div class="ui-status" data-capture-status>{{ capture_status }}</div>
        <button type="button" class="ui-button ui-button--primary" data-action="capture-still-proxy">Capture Still</button>
    </div>
</div>